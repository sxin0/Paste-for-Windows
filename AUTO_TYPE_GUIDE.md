# 🚀 自动上屏功能使用指南

## 功能概述

自动上屏功能允许您双击剪贴板卡片，直接将内容输入到当前激活的应用程序中，无需手动复制粘贴。

## 使用方法

### 基本操作
1. **打开剪贴板历史**：按 `Win+V` 或点击系统托盘图标
2. **双击卡片**：双击任意剪贴板卡片，系统会自动：
   - 切换到上一个激活的窗口
   - 自动聚焦到输入区域
   - 将内容输入到目标窗口

### 智能窗口切换
- **自动切换**：双击卡片时自动切换到上一个窗口
- **窗口历史**：系统会记录最近使用的窗口历史
- **智能聚焦**：自动聚焦到目标窗口的输入区域
- **安全验证**：确保窗口切换成功后再进行输入

### 支持的应用
- ✅ **即时通讯**：微信、QQ、钉钉、Telegram
- ✅ **办公软件**：Word、Excel、PowerPoint、记事本
- ✅ **浏览器**：Chrome、Edge、Firefox（地址栏、搜索框）
- ✅ **代码编辑器**：VS Code、PyCharm、Sublime Text
- ✅ **其他应用**：大多数支持文本输入的应用程序

## 技术原理

### 输入方式
1. **剪贴板方式**（默认，推荐）
   - 将内容复制到剪贴板
   - 模拟 `Ctrl+V` 粘贴操作
   - 恢复原始剪贴板内容
   - 优点：速度快，支持特殊字符，不会触发输入法

2. **键盘方式**（备用）
   - 逐字符模拟键盘输入
   - 优点：不依赖剪贴板
   - 缺点：速度较慢，可能触发输入法

### 安全检查
系统会自动检查当前窗口是否安全，避免在以下窗口进行自动输入：
- 任务管理器
- 命令提示符
- 文件资源管理器
- 系统管理工具
- 包含"管理员"、"系统"等关键词的窗口

## 故障排除

### 自动上屏失败
如果自动上屏失败，系统会自动回退到剪贴板方式：
1. 内容会被复制到剪贴板
2. 显示通知提示手动粘贴
3. 您可以手动按 `Ctrl+V` 粘贴内容

### 常见问题

**Q: 为什么在某些应用中无法自动上屏？**
A: 可能是因为：
- 应用不支持剪贴板操作
- 应用有特殊的安全限制
- 当前窗口没有输入焦点

**Q: 如何确保自动上屏成功？**
A: 建议：
- 确保目标窗口处于激活状态
- 确保光标在输入区域
- 避免在系统关键窗口中使用

**Q: 自动上屏会影响我的剪贴板内容吗？**
A: 不会。系统会：
- 保存您当前的剪贴板内容
- 临时使用剪贴板进行输入
- 自动恢复您原来的剪贴板内容

## 测试功能

### 基础功能测试
运行测试脚本验证基础功能：
```bash
python test_auto_type.py
```

### 窗口切换功能测试
运行窗口切换测试脚本：
```bash
python test_window_switch.py
```

测试步骤：
1. 打开记事本或其他文本编辑器
2. 在编辑器中点击，确保有输入焦点
3. 按 Alt+Tab 切换到其他窗口（如浏览器）
4. 运行测试脚本
5. 观察窗口切换和文本输入效果

## 安全注意事项

- ⚠️ 不要在系统关键窗口中使用自动上屏
- ⚠️ 不要在管理员权限的应用程序中使用
- ⚠️ 不要在命令行工具中使用
- ✅ 建议在普通应用程序中使用（如聊天软件、文本编辑器等）

## 配置选项

可以通过修改 `src/utils/auto_type.py` 中的参数来调整功能：

```python
# 输入延迟设置
self.type_delay = 0.01  # 每个字符之间的延迟
self.line_delay = 0.1   # 换行符的额外延迟

# 安全检查设置
dangerous_classes = [...]  # 危险窗口类名列表
dangerous_keywords = [...]  # 危险关键词列表
```

## 更新日志

### v1.1.0
- ✅ 实现智能窗口切换功能
- ✅ 添加窗口历史记录管理
- ✅ 自动切换到上一个激活的窗口
- ✅ 智能聚焦到输入区域

### v1.0.0
- ✅ 实现基础自动上屏功能
- ✅ 支持剪贴板和键盘两种输入方式
- ✅ 添加安全检查机制
- ✅ 实现自动回退到剪贴板方式
- ✅ 添加详细的错误处理和用户反馈 